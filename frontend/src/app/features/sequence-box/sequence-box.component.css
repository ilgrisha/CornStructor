/* ============================================================================
 * Path: frontend/src/app/features/sequence-box/sequence-box.component.css
 * Version: v2.8.0
 * ============================================================================
 * NEW: .caret absolute overlay with len+1 1ch columns; blinking bar appears
 *      exactly at column boundaries. Hidden/dimmed when not focused.
 *
 * NOTE (v2.8.0): Fully compatible with the new 'stems' overlay. Bars are colored
 * via inline styles from AnalysisService.featureColor(kind), so no extra CSS
 * classes are required for stems.
 * ==========================================================================*/
.card{background:#fff;border:1px solid #e5e5ea;border-radius:16px;box-shadow:0 1px 3px rgba(0,0,0,.06);padding:12px}
.card-header{display:flex;justify-content:space-between;align-items:baseline;margin-bottom:6px}
.title{font-weight:600;color:#0f172a}
.meta{color:#64748b;font-size:12px;display:flex;gap:8px;flex-wrap:wrap}

.controls{display:flex;justify-content:space-between;align-items:center;margin:6px 0 8px 0}
.hide-all{font-size:12px;color:#475569;display:flex;align-items:center;gap:8px}
.right-controls{display:flex;align-items:center;gap:10px}
.upload input[type=file]{display:none}
.upload{background:#f3f4f6;border:1px solid #e5e7eb;padding:4px 8px;border-radius:8px;font-size:12px;color:#374151;cursor:pointer}
.cols{font-size:12px;color:#64748b}
.design-overlay-controls{
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  align-items:flex-end;
  margin:0 0 10px 0;
}
.overlay-field{display:flex;flex-direction:column;gap:4px}
.overlay-field label{font-size:12px;color:#475569}
.overlay-field select{
  border:1px solid #d1d5db;
  border-radius:8px;
  padding:4px 8px;
  font-size:12px;
  font-family:inherit;
  min-width:180px;
}
.overlay-clear{
  border:1px solid #d1d5db;
  border-radius:8px;
  background:#fff;
  padding:4px 10px;
  font-size:12px;
  color:#334155;
  cursor:pointer;
}
.overlay-clear:disabled{opacity:.5;cursor:not-allowed}
.overlay-legend{
  display:flex;
  gap:12px;
  font-size:12px;
  color:#475569;
  align-items:center;
}
.overlay-legend .swatch{
  display:inline-block;
  width:12px;
  height:6px;
  border-radius:4px;
  margin-right:4px;
}
.overlay-legend .sense{background:#38bdf8;}
.overlay-legend .antisense{background:#ec4899;}
.overlay-warning{
  flex-basis:100%;
  font-size:12px;
  color:#b45309;
  background:#fef9c3;
  border:1px solid #fde68a;
  border-radius:8px;
  padding:6px 10px;
}
.fragment-details{
  border:1px solid #e2e8f0;
  border-radius:10px;
  padding:10px;
  background:#f8fafc;
  font-size:12px;
  color:#0f172a;
  margin-bottom:10px;
}
.details-header{
  font-weight:600;
  display:flex;
  align-items:center;
  gap:8px;
  margin-bottom:6px;
}
.badge{
  background:#0ea5e9;
  color:#fff;
  border-radius:999px;
  padding:2px 8px;
  font-size:10px;
  text-transform:uppercase;
  letter-spacing:0.04em;
}
.badge.secondary{background:#64748b;}
.details-grid{
  display:grid;
  grid-template-columns:120px 1fr;
  gap:4px 12px;
}
.details-grid>div:nth-child(odd){
  font-weight:500;
  color:#475569;
}

/* Prevent native selection — custom selection only */
.viz, .viz *{user-select:none}
.viz{max-height:52vh;overflow:auto;border:1px solid #e5e7eb;border-radius:12px;padding:8px;background:#fcfcfd;outline:none}
.viz:focus{box-shadow:0 0 0 3px rgba(59,130,246,.15);border-color:#93c5fd}

.grid{display:grid;gap:0}
.mono{font-family:ui-monospace,SFMono-Regular,Menlo,monospace;font-size:13px;line-height:1.35;letter-spacing:0;font-variant-numeric:tabular-nums}

/* Per-line container to host absolute caret overlay */
.line{position:relative}

/* Bases */
.nt{display:inline-block;width:1ch;text-align:center;cursor:text}
.nt.sel{background:rgba(59,130,246,.28); outline:1px solid rgba(59,130,246,.35); border-radius:2px}
.nt-a{color:#e11d48}
.nt-c{color:#0ea5e9}
.nt-g{color:#16a34a}
.nt-t{color:#f59e0b}
.nt-x{color:#b91c1c;background:#fee2e2;border-radius:2px}

/* Caret overlay — aligned 1ch; sits over the base row */
.caret{
  position:absolute; inset:auto 0 auto 0; /* width full, height set below */
  top:0; height:1.35em; /* same as .mono line-height */
  pointer-events:none; z-index:3;
}
.caretcell{position:relative; width:1ch; height:100%}
.caretcell.on::after{
  content:""; position:absolute; left:0; top:10%;
  width:1px; height:80%;
  background:#0f172a;
  animation:caretblink 1s steps(1,end) infinite;
}
/* Dim / stop blinking when not focused */
.viz:not(:focus) .caretcell.on::after{ opacity:.35; animation:none }

/* Ticks */
.tick{height:6px;margin:1px 0 0 0}
.tickcell{position:relative;display:inline-block;width:1ch;height:100%}
.tickcell.on::after{
  content:"";position:absolute;left:50%;transform:translateX(-50%);
  top:0;width:1px;height:4px;background:#cbd5e1;border-radius:1px;
}

/* Ruler */
.ruler{color:#94a3b8}
.ruler .r{display:inline-block;width:1ch;text-align:center;transform:scale(0.82);transform-origin:center top;line-height:1.1}

/* Range bars */
.bars{height:6px;margin:2px 0;font-family:ui-monospace,SFMono-Regular,Menlo,monospace;font-size:13px}
.bars.sel{height:8px}
.bars.design{height:6px}
.bars.design .barcell{opacity:0.75}
.bars.design .segment{
  border:none;
  padding:0;
  margin:0;
  cursor:pointer;
  background:transparent;
  display:block;
  width:100%;
  height:100%;
  border-radius:2px;
  position:relative;
}
.bars.design .segment:hover{
  opacity:0.95;
  box-shadow:0 0 0 2px rgba(15,23,42,.5);
}
.bars.design .segment::after{
  content:attr(data-frag-label);
  position:absolute;
  bottom:100%;
  left:50%;
  transform:translate(-50%, -4px);
  background:#0f172a;
  color:#fff;
  font-size:10px;
  padding:1px 4px;
  border-radius:3px;
  opacity:0;
  pointer-events:none;
  white-space:nowrap;
}
.bars.design .segment:hover::after{
  opacity:1;
}
.bars.design .segment.selected{
  opacity:1;
  box-shadow:0 0 0 2px rgba(15,23,42,.35);
}
.bars.design.sense .segment{box-shadow:0 0 0 1px rgba(56,189,248,.3);}
.bars.design.antisense .segment{box-shadow:0 0 0 1px rgba(236,72,153,.25);}
.barcell{width:1ch;height:100%;border-radius:2px;opacity:.35}
.bars.sel .barcell{opacity:1}

.placeholder{padding:20px 8px;color:#64748b;font-size:13px}

@keyframes caretblink { 0%{opacity:1} 50%{opacity:0} 100%{opacity:1} }
