<!-- =========================================================================
     Path: frontend/src/app/features/feature-picker/feature-picker.component.html
     Version: v2.0.0
     ========================================================================= -->
<div class="card">
  <div class="card-header">
    <div class="title">Detected features</div>
  </div>

  <!-- Kind selector -->
  <div class="kinds">
    <button
      class="chip"
      *ngFor="let k of kinds()"
      [class.active]="a.selectedKind() === k"
      (click)="selectKind(k)">
      <span class="dot" [style.background]="a.featureColor(k)"></span>
      {{ k }} <span class="count">{{ counts()[k] }}</span>
    </button>
    <button class="chip clear" *ngIf="a.selectedKind()" (click)="clearKind()">Clear</button>
  </div>

  <!-- Scrollable ranges area (vertical only). No horizontal scroll. -->
  <div class="ranges-scroll">
    <!-- Pinned selected row (sticky at top) -->
    <div class="pinned" *ngIf="selected()">
      <span class="swatch" [style.background]="kindColor()"></span>
      <div class="cols">
        <div><span class="label">start</span><span class="mono">{{ selected()!.start + 1 }}</span></div>
        <div><span class="label">end</span><span class="mono">{{ selected()!.end }}</span></div>
        <div><span class="label">length</span><span class="mono">{{ len(selected()!) }}</span></div>
      </div>
      <button class="link" (click)="clearRange()">Clear</button>
    </div>

    <!-- Compact 3-column table -->
    <table *ngIf="ranges().length; else noSel">
      <thead>
        <tr>
          <th>start</th>
          <th>end</th>
          <th>length</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let r of ranges(); let i = index; trackBy: i"
            [class.selected]="i === selectedIdx()"
            (click)="pick(i)">
          <td class="mono">{{ r.start + 1 }}</td>
          <td class="mono">{{ r.end }}</td>
          <td class="mono">{{ len(r) }}</td>
        </tr>
      </tbody>
    </table>

    <ng-template #noSel>
      <div class="empty">Choose a feature above to see its merged ranges.</div>
    </ng-template>
  </div>
</div>
