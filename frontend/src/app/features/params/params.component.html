<!-- =========================================================================
Path: frontend/src/app/features/params/params.component.html
Version: v2.6.0
========================================================================= -->

<div class="card card--compact">
  <div class="card-header">
    <div class="title">Parameters</div>
  </div>

  <!-- Homopolymers -->
  <section class="group">
    <div class="group-title">Homopolymers</div>
    <div class="row grid">
      <label class="control">
        <span>Min length</span>
        <input
          type="number"
          min="2"
          step="1"
          [value]="p().homoMin"
          (input)="updateNum('homoMin', $event)"
        />
      </label>
    </div>
  </section>

  <!-- GC% -->
  <section class="group">
    <div class="group-title">GC%</div>
    <div class="row grid grid-3">
      <label class="control">
        <span>Window</span>
        <input
          type="number"
          min="1"
          step="1"
          [value]="p().gcWin"
          (input)="updateNum('gcWin', $event)"
        />
      </label>
      <label class="control">
        <span>Min %</span>
        <input
          type="number"
          min="0"
          max="100"
          step="1"
          [value]="p().gcMin"
          (input)="updateNum('gcMin', $event)"
        />
      </label>
      <label class="control">
        <span>Max %</span>
        <input
          type="number"
          min="0"
          max="100"
          step="1"
          [value]="p().gcMax"
          (input)="updateNum('gcMax', $event)"
        />
      </label>
    </div>
  </section>

  <!-- Low complexity -->
  <section class="group">
    <div class="group-title">Low complexity (Shannon)</div>
    <div class="row grid grid-2">
      <label class="control">
        <span>Window</span>
        <input
          type="number"
          min="5"
          step="1"
          [value]="p().entropyWin"
          (input)="updateNum('entropyWin', $event)"
        />
      </label>
      <label class="control">
        <span>Entropy min (bits)</span>
        <input
          type="number"
          step="0.1"
          [value]="p().entropyMin"
          (input)="updateNum('entropyMin', $event)"
        />
      </label>
    </div>
  </section>

  <!-- Repeats -->
  <section class="group">
    <div class="group-title">Repeats (tandem)</div>
    <div class="row grid grid-3">
      <label class="control">
        <span>k min</span>
        <input
          type="number"
          min="1"
          step="1"
          [value]="p().repeatKmin"
          (input)="updateNum('repeatKmin', $event)"
        />
      </label>
      <label class="control">
        <span>k max</span>
        <input
          type="number"
          min="1"
          step="1"
          [value]="p().repeatKmax"
          (input)="updateNum('repeatKmax', $event)"
        />
      </label>
      <label class="control">
        <span>Min repeats</span>
        <input
          type="number"
          min="2"
          step="1"
          [value]="p().repeatMinReps"
          (input)="updateNum('repeatMinReps', $event)"
        />
      </label>
    </div>
  </section>

  <!-- Long repeats (approximate, no gaps) -->
  <section class="group">
    <div class="group-title">Long repeats (approximate)</div>
    <div class="row grid grid-2">
      <label class="control">
        <span>Min length (bp)</span>
        <input
          type="number"
          min="10"
          step="1"
          [value]="p().longRepMinLen"
          (input)="updateNum('longRepMinLen', $event)"
        />
      </label>
      <label class="control">
        <span>Min identity (%)</span>
        <input
          type="number"
          min="50"
          max="100"
          step="1"
          [value]="p().longRepMinPct"
          (input)="updateNum('longRepMinPct', $event)"
        />
      </label>
    </div>
  </section>

  <!-- NEW: Secondary structure (stems) -->
  <section class="group">
    <div class="group-title">Secondary structure (stems)</div>
    <div class="row grid grid-2">
      <label class="control" title="Minimal merged linear region to keep">
        <span>Min stem length (bp)</span>
        <input
          type="number"
          min="1"
          step="1"
          [value]="p().stemMinLen"
          (input)="updateNum('stemMinLen', $event); a.refreshStems()"
        />
      </label>
      <label class="control" title="Merge adjacent stems when the unpaired gap ≤ this value">
        <span>Merge gap ≤ (bp)</span>
        <input
          type="number"
          min="0"
          step="1"
          [value]="p().stemMergeMaxGap"
          (input)="updateNum('stemMergeMaxGap', $event); a.refreshStems()"
        />
      </label>
    </div>
  </section>
</div>
